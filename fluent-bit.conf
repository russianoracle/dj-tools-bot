[SERVICE]
    Flush         5
    Daemon        off
    Log_Level     info
    Parsers_File  parsers.conf

[INPUT]
    Name              tail
    Path              /var/lib/docker/containers/*/*.log
    Parser            docker
    Tag               docker.*
    Refresh_Interval  5
    Mem_Buf_Limit     5MB
    Skip_Long_Lines   On

[FILTER]
    Name                parser
    Match               docker.*
    Key_Name            log
    Parser              json
    Reserve_Data        On
    Preserve_Key        Off

[FILTER]
    Name                modify
    Match               docker.*
    Add                 source mood-classifier
    Add                 environment production

[FILTER]
    Name                nest
    Match               docker.*
    Operation           lift
    Nested_under        log
    Add_prefix          log_

[OUTPUT]
    Name  yc-logging
    Match docker.*
    resource_type generic_node
    group_id ${YC_LOG_GROUP_ID}
    message_key log_message
    level_key log_level
    default_level INFO
    authorization iam-token
    iam_token ${YC_TOKEN}
    labels component=$log_component,correlation_id=$log_correlation_id,user_id=$log_user_id
