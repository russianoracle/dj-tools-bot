# ============================================================================
# Test Image - extends production image with test dependencies
# ============================================================================

# Use build-context to reference local prod image from Docker daemon
# Build with: docker buildx build --build-context prod-image=docker-image://mood-classifier:prod-local
ARG PROD_IMAGE_CONTEXT=prod-image
FROM ${PROD_IMAGE_CONTEXT}

# Install test dependencies
RUN pip install --no-cache-dir \
    pytest>=7.4.0 \
    pytest-asyncio>=0.21.0 \
    pytest-timeout>=2.1.0

# Set working directory
WORKDIR /app

# Default command for running tests
CMD ["pytest", "tests/", "-vv"]
